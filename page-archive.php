<?php/** * The template for displaying the Archive page * * @link https://developer.wordpress.org/themes/basics/template-hierarchy/#single-post * * @package Ayin * @since 1.0.0 */get_header();?><section id="primary" class="content-area">	<main id="main" class="site-main" role="main"><?php		while ( have_posts() ) : ?>		<article id="post-<?php the_ID(); ?>" <?php post_class(); ?>>			<div class="entry-content"><?php				wp_reset_postdata();				the_post();				the_content(					sprintf(						wp_kses(						/* translators: %s: Name of current post. Only visible to screen readers */							__( 'Continue reading<span class="screen-reader-text"> "%s"</span>', 'ayin' ),							array(								'span' => array(									'class' => array(),								),							)						),						get_the_title()					)				); ?>				<div id="archives-filters-container" class="alignwide">					<h4>Filter Archive</h4>					<div class="archives-filters">						<form id="filterForm" name="filterForm">						<div class="archives-filter-group">							<div class="filterHeader">by Genre</div><?php							$tags = get_tags();							foreach ($tags as $tag) {								if ($tag->count > 0) { ?>									<div id="filter1-<?php echo $tag->term_id; ?>" class="archive-filter"><a href="javascript:filter_toggle('1-<?php echo $tag->term_id; ?>');"><?php echo $tag->name; ?></a></div><?php								}							} ?>							<div class="clear"></div>						</div>						<div class="archives-filter-group">							<div class="filterHeader">by Category</div>							<div id="filter2-1" class="archive-filter"><a href="javascript:filter_toggle('2-1');">Books</a></div>							<div id="filter2-2" class="archive-filter"><a href="javascript:filter_toggle('2-2');">Columns</a></div>							<div id="filter2-3" class="archive-filter"><a href="javascript:filter_toggle('2-3');">Folios</a></div>							<div id="filter2-4" class="archive-filter"><a href="javascript:filter_toggle('2-4');">Journals</a></div>							<div id="filter2-5" class="archive-filter"><a href="javascript:filter_toggle('2-5');">Zines</a></div>							<div class="clear"></div>						</div>						<div class="archives-filter-group">							<div class="filterHeader">Text Search</div>							<div id="filter3-1" class="archive-filter archive-text"><input type="text" name="searchText" id="searchText" value="" /><label for="searchText"></label></div>							<div class="clear"></div>						</div>						<div class="archives-filter-group">							<div class="filterHeader">Sort Order</div>							<div id="filter4-1" class="archive-filter archive-radio"><input type="radio" name="sortBy" id="sortBy1" checked /><label for="sortBy1">Chronologically</label></div>							<div id="filter4-2" class="archive-filter archive-radio"><input type="radio" name="sortBy" id="sortBy2" /><label for="sortBy2">Alphabetically</label></div>							<div class="clear"></div>						</div>						</form>					</div>				</div>				<hr class="wp-block-separator has-css-opacity alignfull is-style-wide" />				<div style="height:40px" aria-hidden="true" class="wp-block-spacer"></div>				<div class="is-layout-flex wp-container-9 wp-block-columns alignfull">					<div class="is-layout-flow wp-block-column">						<div class="PostsGridWrapper">							<div class="BlogGrid" id="BlogGridContent">								<div id="AyinGridLoading1" class="AyinGridLoading" style="display: block;"></div>							</div>						</div>					</div>				</div>				<style>					.filterHeader {						font-family: BrownLL, Georgia, Times, serif;						font-weight: 500;					}					.archives-filter-group {						margin-bottom: 20px;					}					.archive-filter {						float: left;						font-family: BrownLL, Georgia, Times, serif;						font-weight: 100;						font-size: 20px;						line-height: 24px;						color: #333;					}					.archive-filter a {						display: block;						font-family: BrownLL, Georgia, Times, serif;						font-weight: 100;						font-size: 20px;						line-height: 24px;						color: #333;						padding: 13px 26px;						background: none;						border: none;					}					.archive-filter a:hover {						background: #fdf5eb;					}					.archive-filter.active a {						background: #fdf5eb;					}					.archive-text {						width: 100%;					}					.archive-text input[type=text] {						border: solid 1px #999;						width: 100%;						max-width: 400px;						font-family: BrownLL, Georgia, Times, serif;						font-weight: 100;						font-size: 20px;						line-height: 24px;						color: #333;					}					.archive-radio input[type=radio] {						width: 30px;					}					.archive-radio {						padding-right: 30px;					}					.clear {						height: 0;						clear: both;					}					@media only screen and (max-width: 650px) {						.archive-filter,						.archive-filter a,						.archive-text input[type=text] {							font-size: 16px;							line-height: 20px;						}						.archive-filter a {							padding: 10px 20px;						}					}				</style>				<script>					let search_toggle = false;					let search_loading = false;					let toggleArray = [];					jQuery(function() {						load_ayin_posts1(1);					});					jQuery('input[type=radio][name=sortBy]').on('change', function() {						load_ayin_posts1(-1);					});					jQuery('#searchText').on('change', function() {						load_ayin_posts1(-1);					});					function load_ayin_posts1(start) {						if (!search_toggle) {							search_toggle = true;							let QS = '&start=';							if (start === -1) {								QS += '1';							} else {								QS += start;							}							QS += '&tA=' + toggleArray;							if (jQuery('#sortBy2').is(':checked')) {								QS += '&sO=alpha';							} else {								QS += '&sO=chrono';							}							QS += '&sT=' + encodeURIComponent(jQuery('#searchText').val());							//console.log(QS);							if (start === -1) {								jQuery('.AyinMorePosts').remove();								jQuery('.BlogGridPost').fadeOut('fast', function() {									jQuery('.AyinGridLoading').fadeIn('fast', function() {										load_posts(1, QS, true);									});								});							} else if (start > 1) {								jQuery('#AyinGrid1MorePosts' + start).fadeOut('fast', function() {									jQuery('#AyinGrid1MorePosts' + start).remove();									jQuery('#AyinGrid1Loading' + start).fadeIn('fast', function() {										load_posts(start, QS, false);									});								});							} else {								load_posts(1, QS, false);							}						}					}					function load_posts(start, QS, scroll) {						if (!search_loading) {							search_loading = true;							if (scroll) {								// scroll browser to top of filters								let barHeight = jQuery('#wpadminbar').length ? jQuery('#wpadminbar').outerHeight() : 0;								let headHeight = jQuery('#masthead').outerHeight();								jQuery('html, body').animate({									scrollTop: jQuery('#archives-filters-container').offset().top - (barHeight + headHeight)								}, 1000);							}							// do ajax call							let date = new Date();							jQuery.ajax({								url: '/wp-content/themes/ayintheme/ajax/load_archive_grid.php?r=' + date.getTime() + QS,								type: 'GET',								dataType: 'text',							}).success(function (results) {								jQuery('.AyinGridLoading').fadeOut('fast', function () {									jQuery('.AyinGridLoading').remove();									jQuery('#BlogGridContent').append(results);								});							}).error(function (XMLHttpRequest, textStatus, errorThrown) {								var errorText = '<div style="padding: 20px; text-align: center; font-weight: 400; font-size: 18px; line-height; 30px;">There was an error while loading more posts. Please try again later.</div>';								jQuery('#AyinGrid1Loading').fadeOut('fast', function () {									jQuery('.AyinGridLoading').remove();									jQuery('#BlogGridContent').append(errorText);								});							}).always(function () {								search_toggle = false;								search_loading = false;							});						}					}					function filter_toggle(tid) {						if (!search_toggle) {							let jToggle = jQuery('#filter' + tid);							if (jToggle.hasClass('active')) {								jToggle.removeClass('active');							} else {								jToggle.addClass('active');							}							update_array(tid);							load_ayin_posts1(-1);						}					}					function update_array(tid) {						var position = toggleArray.indexOf(tid);						if (jQuery('#filter' + tid).hasClass('active')) {							if (position === -1) toggleArray[toggleArray.length] = tid;						} else {							if (position >= 0) toggleArray.splice(position, 1);						}					}                    // prevent "Enter" on text field from submitting form                    document.getElementById('filterForm').addEventListener('keypress', stopSubmit);                    function stopSubmit(e) {                        if (e.keyCode === 13) {                            e.preventDefault();                            load_ayin_posts1(-1);                        }                    }				</script>			</div>		</article><!-- #post-<?php the_ID(); ?> --><?php		endwhile; // End of the loop. ?>	</main><!-- #main --></section><!-- #primary --><?phpget_footer();